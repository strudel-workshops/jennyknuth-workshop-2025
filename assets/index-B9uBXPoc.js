import{d,j as e,B as c,F as H,G as I,H as y,J as T,S as m,T as p,D as N,P as C,o as E,L as v}from"./index-C_esv3Ko.js";import{P as R}from"./PageHeader-q6xholtW.js";import{S as L}from"./SciDataGrid-DBuSURiE.js";import{u as M}from"./useQuery-LnTZPBq8.js";import{S as W}from"./DataGrid-BgdO4lkX.js";import{A as k,C as z}from"./Close-DelDB2s9.js";import{M as F}from"./MenuItem-Cawnrdcm.js";import"./Grid-DSLlgHZO.js";import"./FilterField-Dgk3Dj27.js";import"./DatePicker-BUtziL3L.js";import"./DateCalendar-xC0-uuHP.js";import"./colorManipulator-Cs9wiD9_.js";import"./useGridRootProps-DqF1Eisw.js";import"./Divider-BpligrtP.js";import"./dividerClasses-Ba9Skh6K.js";const B=t=>M({queryKey:["hapi-catalog",t],queryFn:async()=>{const a=await fetch(`${t}/catalog`);if(!a.ok)throw new Error(`Failed to fetch HAPI catalog: ${a.statusText}`);const i=await a.json();if(i.status.code!==1200)throw new Error(`HAPI error: ${i.status.message}`);return i.catalog||[]},staleTime:5*60*1e3}),V=({serverUrl:t,searchTerm:a,setPreviewItem:i})=>{const[s,n]=d.useState(0),[o,g]=d.useState(25),{isPending:S,isFetching:f,isError:j,data:u,error:P}=B(t),b=d.useMemo(()=>{if(!u)return[];if(!a)return u;const r=a.toLowerCase();return u.filter(l=>{var h,x;return l.id.toLowerCase().includes(r)||((h=l.title)==null?void 0:h.toLowerCase().includes(r))||((x=l.description)==null?void 0:x.toLowerCase().includes(r))})},[u,a]),D=r=>{i(r.row)},A=r=>{const l=r.pageSize!==o?0:r.page;n(l),g(r.pageSize)};if(S){const l=new Array(o).fill(null).map((h,x)=>x);return e.jsx(c,{sx:{padding:2},children:l.map(h=>e.jsx(W,{height:50},h))})}return j?e.jsx(k,{severity:"error",children:P.message}):e.jsxs(e.Fragment,{children:[f&&e.jsx(H,{variant:"indeterminate"}),e.jsx(L,{rows:b,pagination:!0,paginationMode:"client",onPaginationModelChange:A,getRowId:r=>r.id,columns:[{field:"id",headerName:"Dataset ID",width:250,flex:1},{field:"title",headerName:"Title",width:300,flex:2},{field:"startDate",headerName:"Start Date",width:180},{field:"stopDate",headerName:"Stop Date",width:180},{field:"description",headerName:"Description",width:400,flex:2}],disableColumnSelector:!0,autoHeight:!0,initialState:{pagination:{paginationModel:{page:s,pageSize:o}}},onRowClick:D})]})},w=[{id:"sscweb",name:"SSCWeb",url:"https://sscweb.gsfc.nasa.gov/WS/hapi"},{id:"cdaweb",name:"CDAWeb",url:"https://cdaweb.gsfc.nasa.gov/hapi"},{id:"intermagnet",name:"INTERMAGNET",url:"https://imag-data.bgs.ac.uk/GIN_V1/hapi"},{id:"lasp",name:"LASP",url:"https://lasp.colorado.edu/lisird/hapi"}],G=({selectedServer:t,onServerChange:a})=>{const i=s=>{const n=w.find(o=>o.id===s.target.value);n&&a(n)};return e.jsxs(I,{sx:{minWidth:200},size:"small",children:[e.jsx(y,{id:"hapi-server-select-label",children:"HAPI Server"}),e.jsx(T,{labelId:"hapi-server-select-label",id:"hapi-server-select",value:t.id,label:"HAPI Server",onChange:i,children:w.map(s=>e.jsx(F,{value:s.id,children:s.name},s.id))})]})},$=({searchTerm:t,setSearchTerm:a,selectedServer:i,onServerChange:s})=>{const n=o=>{a(o.target.value)};return e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",sx:{overflow:"hidden",padding:2},children:[e.jsx(p,{variant:"h6",component:"h2",flex:1,children:"HAPI Datasets"}),e.jsx(G,{selectedServer:i,onServerChange:s}),e.jsx(N,{variant:"outlined",label:"Search",size:"small",value:t,onChange:n})]})},q=({previewItem:t,onClose:a})=>e.jsx(C,{elevation:0,sx:{height:"100%",padding:2},children:e.jsxs(m,{spacing:3,children:[e.jsxs(m,{spacing:1,children:[e.jsxs(m,{direction:"row",children:[e.jsx(p,{variant:"h6",component:"h3",flex:1,children:t.title||t.id}),e.jsx(E,{size:"small",onClick:a,children:e.jsx(z,{})})]}),t.description&&e.jsx(p,{variant:"body2",children:t.description})]}),e.jsxs(c,{children:[e.jsx(p,{fontWeight:"medium",mb:1,children:"Dataset Information"}),e.jsx(v,{rows:[{label:"Dataset ID",value:t.id},{label:"Title",value:t.title||"N/A"},{label:"Contact",value:t.contact||"N/A"}]})]}),e.jsxs(c,{children:[e.jsx(p,{fontWeight:"medium",mb:1,children:"Time Range"}),e.jsx(v,{rows:[{label:"Start Date",value:t.startDate||"N/A"},{label:"Stop Date",value:t.stopDate||"N/A"}]})]})]})}),ne=function(){const[a,i]=d.useState(""),[s,n]=d.useState(),[o,g]=d.useState(w[0]),S=j=>{g(j),n(null)},f=()=>{n(null)};return e.jsxs(c,{children:[e.jsx(R,{pageTitle:"HAPI Data Explorer",description:"Browse and explore datasets from HAPI (Heliophysics Application Programmer's Interface) servers",sx:{marginBottom:1,padding:2}}),e.jsx(c,{children:e.jsxs(m,{direction:"row",children:[e.jsxs(C,{elevation:0,sx:{flex:1,minHeight:"600px",minWidth:0},children:[e.jsx($,{searchTerm:a,setSearchTerm:i,selectedServer:o,onServerChange:S}),e.jsx(V,{serverUrl:o.url,searchTerm:a,setPreviewItem:n})]}),s&&e.jsx(c,{sx:{minWidth:"400px"},children:e.jsx(q,{previewItem:s,onClose:f})})]})})]})};export{ne as component};
