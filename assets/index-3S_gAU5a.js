import{d,j as e,B as c,F as H,G as I,H as y,J as N,S as m,T as p,D as T,P,o as E,L as v}from"./index-Ic9I08Tq.js";import{P as R}from"./PageHeader-kcPw-UtQ.js";import{S as k}from"./SciDataGrid-CnWvGagf.js";import{u as L}from"./useQuery-C-5qjxsS.js";import{S as M}from"./DataGrid-MbbA8yZM.js";import{A as z,C as F}from"./Close-ZtWQ8UKb.js";import{M as W}from"./MenuItem-BIWk3y1P.js";import"./Grid-FlfWlkgh.js";import"./FilterField-CawBaNVo.js";import"./DatePicker-BAViKDrw.js";import"./DateCalendar-Bfp328Lr.js";import"./colorManipulator-DKt10aMW.js";import"./useGridRootProps-CqWolZO3.js";import"./Divider-DoAjbY1g.js";import"./dividerClasses-DxtS9DvU.js";const B=t=>L({queryKey:["hapi-catalog",t],queryFn:async()=>{const a=await fetch(`${t}/catalog`);if(!a.ok)throw new Error(`Failed to fetch HAPI catalog: ${a.statusText}`);const s=await a.json();if(s.status.code!==1200)throw new Error(`HAPI error: ${s.status.message}`);return s.catalog||[]},staleTime:5*60*1e3}),V=({serverUrl:t,searchTerm:a,setPreviewItem:s})=>{const[i,n]=d.useState(0),[o,g]=d.useState(25),{isPending:j,isFetching:f,isError:w,data:u,error:C}=B(t),D=d.useMemo(()=>{if(!u)return[];if(!a)return u;const r=a.toLowerCase();return u.filter(l=>{var h,x;return l.id.toLowerCase().includes(r)||((h=l.title)==null?void 0:h.toLowerCase().includes(r))||((x=l.description)==null?void 0:x.toLowerCase().includes(r))})},[u,a]),b=r=>{s(r.row)},A=r=>{const l=r.pageSize!==o?0:r.page;n(l),g(r.pageSize)};if(j){const l=new Array(o).fill(null).map((h,x)=>x);return e.jsx(c,{sx:{padding:2},children:l.map(h=>e.jsx(M,{height:50},h))})}return w?e.jsx(z,{severity:"error",children:C.message}):e.jsxs(e.Fragment,{children:[f&&e.jsx(H,{variant:"indeterminate"}),e.jsx(k,{rows:D,pagination:!0,paginationMode:"client",onPaginationModelChange:A,getRowId:r=>r.id,columns:[{field:"id",headerName:"Dataset ID",width:250,flex:1},{field:"title",headerName:"Title",width:300,flex:2},{field:"startDate",headerName:"Start Date",width:180},{field:"stopDate",headerName:"Stop Date",width:180},{field:"description",headerName:"Description",width:400,flex:2}],disableColumnSelector:!0,autoHeight:!0,initialState:{pagination:{paginationModel:{page:i,pageSize:o}}},onRowClick:b})]})},S=[{id:"cdaweb",name:"CDAWeb",url:"https://cdaweb.gsfc.nasa.gov/hapi"},{id:"intermagnet",name:"INTERMAGNET",url:"https://imag-data.bgs.ac.uk/GIN_V1/hapi"},{id:"lasp",name:"LASP",url:"https://lasp.colorado.edu/lisird/hapi"},{id:"knmi",name:"KNMI",url:"https://hapi.spaceweather.knmi.nl/hapi"},{id:"helioviewer",name:"Helioviewer",url:"https://api.helioviewer.org/hapi/Helioviewer/hapi"}],G=({selectedServer:t,onServerChange:a})=>{const s=i=>{const n=S.find(o=>o.id===i.target.value);n&&a(n)};return e.jsxs(I,{sx:{minWidth:200},size:"small",children:[e.jsx(y,{id:"hapi-server-select-label",children:"HAPI Server"}),e.jsx(N,{labelId:"hapi-server-select-label",id:"hapi-server-select",value:t.id,label:"HAPI Server",onChange:s,children:S.map(i=>e.jsx(W,{value:i.id,children:i.name},i.id))})]})},$=({searchTerm:t,setSearchTerm:a,selectedServer:s,onServerChange:i})=>{const n=o=>{a(o.target.value)};return e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",sx:{overflow:"hidden",padding:2},children:[e.jsx(p,{variant:"h6",component:"h2",flex:1,children:"HAPI Datasets"}),e.jsx(G,{selectedServer:s,onServerChange:i}),e.jsx(T,{variant:"outlined",label:"Search",size:"small",value:t,onChange:n})]})},q=({previewItem:t,onClose:a})=>e.jsx(P,{elevation:0,sx:{height:"100%",padding:2},children:e.jsxs(m,{spacing:3,children:[e.jsxs(m,{spacing:1,children:[e.jsxs(m,{direction:"row",children:[e.jsx(p,{variant:"h6",component:"h3",flex:1,children:t.title||t.id}),e.jsx(E,{size:"small",onClick:a,children:e.jsx(F,{})})]}),t.description&&e.jsx(p,{variant:"body2",children:t.description})]}),e.jsxs(c,{children:[e.jsx(p,{fontWeight:"medium",mb:1,children:"Dataset Information"}),e.jsx(v,{rows:[{label:"Dataset ID",value:t.id},{label:"Title",value:t.title||"N/A"},{label:"Contact",value:t.contact||"N/A"}]})]}),e.jsxs(c,{children:[e.jsx(p,{fontWeight:"medium",mb:1,children:"Time Range"}),e.jsx(v,{rows:[{label:"Start Date",value:t.startDate||"N/A"},{label:"Stop Date",value:t.stopDate||"N/A"}]})]})]})}),ne=function(){const[a,s]=d.useState(""),[i,n]=d.useState(),[o,g]=d.useState(S[0]),j=w=>{g(w),n(null)},f=()=>{n(null)};return e.jsxs(c,{children:[e.jsx(R,{pageTitle:"HAPI Data Explorer",description:"Browse and explore datasets from HAPI (Heliophysics Application Programmer's Interface) servers",sx:{marginBottom:1,padding:2}}),e.jsx(c,{children:e.jsxs(m,{direction:"row",children:[e.jsxs(P,{elevation:0,sx:{flex:1,minHeight:"600px",minWidth:0},children:[e.jsx($,{searchTerm:a,setSearchTerm:s,selectedServer:o,onServerChange:j}),e.jsx(V,{serverUrl:o.url,searchTerm:a,setPreviewItem:n})]}),i&&e.jsx(c,{sx:{minWidth:"400px"},children:e.jsx(q,{previewItem:i,onClose:f})})]})})]})};export{ne as component};
